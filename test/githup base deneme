#!/usr/bin/env python3
import sys
import json
from pathlib import Path

DB = Path.home() / ".simple_todo.json"

def load():
    if DB.exists():
        return json.loads(DB.read_text())
    return []

def save(items):
    DB.write_text(json.dumps(items, indent=2))

def list_items(items):
    if not items:
        print("No todos.")
        return
    for i, it in enumerate(items, 1):
        status = "âœ“" if it["done"] else " "
        print(f"{i}. [{status}] {it['text']}")

def add(items, text):
    items.append({"text": text, "done": False})
    save(items)
    print("Added.")

def done(items, idx):
    try:
        items[idx-1]["done"] = True
        save(items)
        print("Marked done.")
    except:
        print("Invalid index.")

def main():
    items = load()
    if len(sys.argv) < 2:
        print("Usage: add/list/done")
        return
    cmd = sys.argv[1]
    if cmd == "list":
        list_items(items)
    elif cmd == "add" and len(sys.argv) >= 3:
        add(items, " ".join(sys.argv[2:]))
    elif cmd == "done" and len(sys.argv) == 3:
        done(items, int(sys.argv[2]))
    else:
        print("Unknown or incorrect usage.")

if __name
